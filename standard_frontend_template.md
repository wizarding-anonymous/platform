<!-- standard_frontend_template.md -->
# Спецификация Frontend Приложения: {{APP_NAME}}

**Версия:** 1.0
**Дата последнего обновления:** {{YYYY-MM-DD}}
**Ответственная команда:** Frontend Team

## 1. Обзор Приложения (Overview)

### 1.1. Назначение и Роль
*   Краткое описание назначения frontend-приложения (например, "Основной клиентский интерфейс для взаимодействия пользователей с платформой 'Российский Аналог Steam'").
*   Целевые платформы (например, Web, Android, iOS, Desktop - Windows/Linux/MacOS).
*   Ключевые бизнес-задачи, которые решает приложение для пользователя.

### 1.2. Ключевые Функциональности
*   Список основных пользовательских сценариев и функций, реализуемых в приложении (например, просмотр каталога, управление библиотекой, профиль пользователя, процесс покупки, социальные взаимодействия).

### 1.3. Основные Технологии
*   **Язык:** Dart (версия, например, 3.0+)
*   **Framework:** Flutter (версия, например, 3.10+)
*   **Ключевые библиотеки и пакеты:** (Перечислить основные, например, `flutter_bloc` для state management, `go_router` для навигации, `dio` для HTTP. Ссылка на `PACKAGE_STANDARDIZATION.md` и `project_technology_stack.md` для полного списка).
*   Ссылка на `CODING_STANDARDS.md` для стандартов кодирования.

## 2. Архитектура Приложения (Application Architecture)

### 2.1. Общее Описание
*   Выбранный архитектурный паттерн (например, Clean Architecture, MVVM, MVC). Краткое обоснование выбора.
*   Диаграмма верхнеуровневой архитектуры (если есть, можно вставить Mermaid диаграмму).
    ```mermaid
    graph TD
        A[Presentation Layer (UI, Widgets, BLoCs/Controllers)] --> B(Domain Layer (Entities, Use Cases, Repository Interfaces));
        B --> C(Data Layer (Repository Implementations, Data Sources));
        C --> D[External (API, Local Storage, Platform Services)];
    ```
*   Основные принципы (например, SOLID, DRY, KISS).

### 2.2. Слои Приложения (Layers)

#### 2.2.1. Presentation Layer (Слой Представления)
*   Ответственность: Отображение UI, обработка пользовательского ввода, взаимодействие с Domain Layer через BLoCs/Controllers/ViewModels.
*   Компоненты:
    *   **Widgets (Виджеты):** Структура (атомарные, компоненты, экраны), кастомные виджеты.
    *   **BLoCs/Cubits/Controllers/ViewModels:** Управление состоянием UI, обработка событий от UI и вызов Use Cases.
    *   **Навигация (Routing):** Как определяются и управляются маршруты.

#### 2.2.2. Domain Layer (Доменный Слой / Бизнес-логика)
*   Ответственность: Бизнес-правила, сущности, сценарии использования (Use Cases). Независим от UI и деталей источников данных.
*   Компоненты:
    *   **Entities (Сущности):** Модели данных бизнес-домена.
    *   **Use Cases (Сценарии использования):** Реализация конкретных бизнес-операций.
    *   **Repository Interfaces (Интерфейсы Репозиториев):** Абстракции для доступа к данным.

#### 2.2.3. Data Layer (Слой Данных)
*   Ответственность: Реализация интерфейсов репозиториев, взаимодействие с источниками данных (API, локальное хранилище).
*   Компоненты:
    *   **Repository Implementations (Реализации Репозиториев):** Конкретные классы, реализующие интерфейсы из Domain Layer.
    *   **Data Sources (Источники данных):**
        *   Remote Data Sources (API клиенты, работа с HTTP/gRPC).
        *   Local Data Sources (Работа с базами данных SQLite/Hive, SharedPreferences, Secure Storage).
    *   **Models (Модели данных):** DTO для API, модели для локального хранения.

### 2.3. Структура Директорий Проекта
*   Описание принятой структуры папок и файлов в проекте.
    ```
    /lib
        /src
            /app                # Инициализация приложения, DI, темы, роутинг
            /core               # Базовые утилиты, константы, расширения
            /features           # Функциональные модули (например, auth, catalog, profile)
                /[feature_name]
                    /data           # Data sources, repositories impl, models
                    /domain         # Entities, use cases, repository interfaces
                    /presentation   # BLoCs/Cubits, screens/pages, widgets
            /generated          # Сгенерированный код (локализация, моки)
        main.dart
    /test
        /features
            /[feature_name]
                /data
                /domain
                /presentation
        /mocks
    ...
    ```

## 3. Управление Состоянием (State Management)

*   Выбранное основное решение (например, `flutter_bloc`, `Riverpod`, `Provider`). Обоснование выбора.
*   Основные паттерны использования (например, разделение на локальное состояние виджетов и глобальное состояние приложения).
*   Примеры реализации для типичных сценариев.

## 4. Навигация (Routing)

*   Выбранное решение (например, `go_router`, `auto_route`, `Navigator 2.0` напрямую).
*   Определение маршрутов, передача параметров.
*   Защита маршрутов (Route guards), аутентификация.
*   Deep linking.

## 5. Взаимодействие с API (API Integrations)

### 5.1. HTTP Клиент
*   Выбранный HTTP клиент (например, `dio`, `http`).
*   Настройка клиента (базовый URL, таймауты, interceptors для добавления токенов, логирования, обработки ошибок).
*   Формат запросов и ответов (JSON).
*   Модели данных для запросов/ответов (Data Transfer Objects - DTOs), использование `json_serializable` или `freezed`.

### 5.2. Обработка Ошибок API
*   Стандартные ошибки, возвращаемые API Gateway и микросервисами.
*   Как ошибки API преобразуются в состояния UI (например, отображение сообщений пользователю, retry-механизмы).
*   Обработка сетевых ошибок, таймаутов.

### 5.3. WebSocket (если используется)
*   Назначение (например, для real-time уведомлений, чата).
*   Выбранная библиотека (например, `web_socket_channel`).
*   Формат сообщений, обработка подключения/отключения.

## 6. Управление Ресурсами (Asset Management)

*   Изображения (форматы, оптимизация, использование `flutter_svg` для векторной графики).
*   Шрифты (подключение кастомных шрифтов).
*   Другие ресурсы (например, JSON-файлы с конфигурацией).
*   Структура папки `assets`.

## 7. Локализация (Localization - l10n)

*   Подход к локализации (например, использование пакета `intl` и ARB-файлов).
*   Процесс добавления новых языков и строк.
*   Автоматическая генерация кода для локализации.
*   Поддерживаемые языки (например, Русский, Английский).

## 8. Сборка Приложения (Build Process)

### 8.1. Окружения (Environments)
*   Описание различных окружений (например, dev, staging, prod).
*   Управление конфигурациями для разных окружений (например, через `.env` файлы, Flutter flavors).

### 8.2. Сборка для Различных Платформ
*   **Web:** `flutter build web --release --dart-define=ENV=prod` (пример). Особенности сборки (renderers: canvaskit, html).
*   **Android:** `flutter build apk --release --flavor prod`, `flutter build appbundle --release --flavor prod`. Подпись приложения.
*   **iOS:** `flutter build ios --release --flavor prod`. Подпись и настройка в Xcode.
*   **Desktop (Windows, Linux, macOS):** `flutter build <platform> --release --flavor prod`. Особенности сборки для каждой платформы.

## 9. Тестирование (Testing)

### 9.1. Типы Тестов
*   **Unit Tests (Модульные тесты):** Тестирование отдельных функций, методов, классов (BLoCs, Use Cases, утилиты).
*   **Widget Tests (Виджет-тесты):** Тестирование отдельных виджетов, проверка их отображения и взаимодействия.
*   **Integration Tests (Интеграционные тесты):** Тестирование взаимодействия нескольких компонентов или всего приложения. Для Flutter это часто тесты, запускаемые на устройстве/эмуляторе.
*   (Опционально) **Golden Tests (Скриншот-тесты):** Проверка UI на соответствие эталонным изображениям.

### 9.2. Инструменты и Библиотеки
*   `flutter_test` (встроенный).
*   `mockito` или `mocktail` для создания моков.
*   `bloc_test` для тестирования BLoCs/Cubits.
*   `integration_test` (встроенный).

### 9.3. Покрытие Тестами (Test Coverage)
*   Целевое покрытие кода тестами (например, >80% для Domain и Data layers).
*   Команда для генерации отчета о покрытии: `flutter test --coverage`.

### 9.4. Запуск Тестов
*   Локально: `flutter test`.
*   CI: Автоматический запуск всех тестов на CI/CD.

## 10. Стандарты Кода и Линтинг (Linting and Formatting)

*   Использование `flutter_lints` или кастомного набора правил в `analysis_options.yaml`.
*   Автоматическое форматирование кода (`dart format`).
*   Соблюдение принципов чистого кода, DRY, SOLID.
*   Соглашения по именованию файлов, классов, переменных.

## 11. Зависимости и Управление Пакетами (Dependencies)

*   Файл `pubspec.yaml`.
*   Политика обновления зависимостей (например, регулярный просмотр `flutter pub outdated`).
*   Использование стабильных версий пакетов.

## 12. Безопасность (Security Best Practices)

*   Хранение чувствительных данных (токены, ключи API) с использованием `flutter_secure_storage`.
*   Защита от распространенных уязвимостей (XSS для Web, небезопасная передача данных).
*   Проверка SSL-сертификатов.
*   Обфускация кода (если требуется).
*   Регулярный аудит зависимостей на уязвимости.
*   Ссылка на `project_security_standards.md`.

## 13. Производительность (Performance Considerations)

*   Профилирование приложения (Flutter DevTools).
*   Оптимизация отрисовки виджетов (использование `const` конструкторов, `ListView.builder`, избегание ненужных перестроений).
*   Работа с изображениями (кэширование, правильные размеры).
*   Минимизация использования ресурсов устройства (батарея, CPU, память).
*   Асинхронные операции и изоляты для тяжелых вычислений.

## 14. Логирование и Отчеты об Ошибках (Logging and Error Reporting)

*   Используемые инструменты (например, `logging` пакет, Sentry, Firebase Crashlytics).
*   Уровни логирования.
*   Сбор и отправка отчетов об ошибках в централизованную систему.

## 15. Приложения (Appendices) (Опционально)

*   Примеры кода для ключевых паттернов.
*   Ссылки на полезные ресурсы, статьи.
*   Другая вспомогательная информация.

---
*Этот шаблон является отправной точкой и должен быть адаптирован и детализирован командой frontend-разработки.*
